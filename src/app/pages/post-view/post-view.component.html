<section class="question">
    <div class="container question__container">
        <article class="question__post" *ngIf="post" [@appearance]="">
            <div class="question__info">
              <small class="question__date">{{post.date | date}}</small>

              <small class="question__author">
                  {{post.author}}
              </small>

            </div>

            <h2 class="question__title">{{post.title}}</h2>

            <p class="question__text">
                {{post.text}}
            </p>

            <div class="question__info">
                <ul class="question__tags">
                    <li class="question__tag" *ngFor="let tag of post.tags">
                        <a class="question__tag-link">{{tag}}</a>
                    </li>
                </ul>

                <div class="question__buttons">
                  <div class="question__post-moderation" *ngIf="isAdmin">
                    <button
                      class="question__post-approve"
                      type="button"
                      (click)="approvePost(post.id)"
                      *ngIf="!post.isApproved && isAdmin"
                    >Approve</button>

                    <button
                      class="question__post-delete"
                      type="button"
                      (click)="deletePost(post.id)"
                      *ngIf="isAdmin"
                    >Delete</button>
                  </div>
                    <a
                      class="question__edit"
                      [routerLink]="'/edit-post/' + post.id"
                      *ngIf="postMeta.isAuthor && !post.isApproved"
                    >Edit</a>

                    <a class="question__back" routerLink="/home">Back</a>
                </div>
            </div>
        </article>

        <div class="question__media" *ngIf="post?.isApproved">
            <h2 class="question__media-title">Comments / Answers</h2>

            <form class="question__form" [formGroup]="form" (ngSubmit)="onSubmit()">
                <label>
                    Add comment
                    <textarea
                        class="question__comment-input"
                        type="text"
                        placeholder="Your text..."
                        formControlName="text"
                    ></textarea>
                </label>

              <small class="error" *ngIf="form.get('text')?.errors?.required && form.get('text').touched">
                Text is required!
              </small>

              <small class="error" *ngIf="form.get('text')?.errors?.minlength && form.get('text').touched">
                Text must contain at least {{form.get('text')?.errors?.minlength.requiredLength}} characters!
              </small>

              <small class="error" *ngIf="form.get('text')?.errors?.maxlength && form.get('text').touched">
                Text must contain no more than {{form.get('text')?.errors?.maxlength.requiredLength}} characters!
              </small>

                <button class="question__submit-comment" type="submit">Submit comment</button>
            </form>

            <ul class="question__comments" *ngIf="comments?.length">
                <li *ngFor="let comment of comments">
                    <article class="question__comment" [@appearance]="">
                        <div class="question__comment-author">
                            <img src="../../../assets/png/user.png" alt="user avatar">

                            <p class="question__comment-email">{{comment.author}}</p>
                        </div>

                        <p class="question__comment-text">
                            {{comment.text}}
                        </p>

                        <button
                          class="question__mark"
                          type="button"
                          *ngIf="postMeta.isAuthor && !postMeta.isPostSolved"
                          (click)="markAsSolution(comment.id)"
                        >Mark as solution</button>

                        <span class="question__comment-date">
                          <i>{{comment.date | date: 'd/M/yyyy, h:mm a'}}</i>
                        </span>
                        <small class="question__solution" *ngIf="comment.isSolution">&#10003; Solution</small>
                    </article>
                </li>
            </ul>
        </div>
    </div>
</section>


